title: "Local Test Dashboard"
theme: "dark"
refresh: "5m"

groups:
  - name: "System"
    tiles:
      - name: "Hostname"
        icon: "icon.png"
        slots:
          - name: "status"
            check:
              type: "command"
              target: "hostname"
            rules:
              - match:
                  code: 0
                status: { id: "ok", label: "‚úÖ" }
              - match: {}
                status: { id: "error", label: "‚ùå" }

      - name: "Date"
        icon: "icon.png"
        link: "https://time.is"
        slots:
          - name: "current"
            check:
              type: "command"
              target: "date +%H:%M"
            rules:
              - match:
                  code: 0
                status: { id: "ok", label: "üïê" }

      - name: "Disk"
        icon: "icon.png"
        slots:
          - name: "usage"
            check:
              type: "command"
              target: "df -h / | tail -1 | awk '{print $5}'"
            rules:
              - match:
                  output: "^[0-6]\\d%"
                status: { id: "ok", label: "‚úÖ" }
              - match:
                  output: "^[7-8]\\d%"
                status: { id: "warn", label: "‚ö†Ô∏è" }
              - match: {}
                status: { id: "critical", label: "üî¥" }


  - name: Metrics
    tiles:
      - name: "CPU Usage"
        banner:
          src: "/tmp/cpu.png"
          type: image
        generate:
          command: "prometheus-render --query 'sum(rate(node_cpu_seconds_total{mode!=\"idle\"}[5m])) * 100' --range 24h --title 'CPU %' --output /tmp/cpu.png"
          timeout: "30s"

      - name: "Memory Usage"
        banner:
          src: "/tmp/memory.png"
          type: image
        generate:
          command: "prometheus-render --query '(1 - node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes) * 100' --range 24h --title 'Memory %' --output /tmp/memory.png"
          timeout: "30s"

      - name: "Disk I/O"
        banner:
          src: "/tmp/diskio.png"
          type: image
        generate:
          command: "prometheus-render --query 'rate(node_disk_read_bytes_total[5m]) + rate(node_disk_written_bytes_total[5m])' --range 24h --title 'Disk I/O (bytes/s)' --output /tmp/diskio.png"
          timeout: "30s"

      - name: "Network Traffic"
        banner:
          src: "/tmp/network.png"
          type: image
        generate:
          command: "prometheus-render --query 'rate(node_network_receive_bytes_total{device!=\"lo\"}[5m])' --range 24h --title 'Network RX (bytes/s)' --output /tmp/network.png"
          timeout: "30s"